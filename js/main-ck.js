function updatePosition(e, t) { if (e < -599) t ? nav2El.show() : navEl.attr("class", "fixed"); else { t ? nav2El.hide() : navEl.attr("class", ""); moveHeaderPicture(e); moveTitleOpacity(e) } } function moveNav(e) { navEl.css("top", -e + "px") } function moveHeaderPicture(e) { Modernizr.touch || headerVisualPictureEl.css("bottom", Math.min(0, e / 3) + "px") } function moveTitleOpacity(e) { var t = 1 - e / -300; titleEl.css("opacity", t) } function init() { navEl = $("nav"); headerVisualPictureEl = $("#headerVisualPicture"); wrapperEl = $("#wrapper"); titleEl = $("header").find("h1"); languagesButtonEl = $(".languagesButton"); languagesEl = $(".languages"); tabsLinkEl = $("#tabs").find("a"); mapsContainerEl = $("#mapsContainer"); languagesContainerEl = $(".languagesContainer"); winesLinkEl = $("#winesLink"); winesLayerEl = $("#winesLayer"); winesContainerEl = $("#winesContainer"); menuLinkEl = $("#menuLink"); menuLayerEl = $("#menuLayer"); menuContainerEl = $("#menuContainer"); tabsBackgroundEl = $("#tabsBackground"); nav2El = $("#nav2"); navLogo = $(".navLogo"); Modernizr.touch ? initWithTouch() : initWithoutTouch(); initForAll() } function initWithoutTouch() { $(window).on("scroll", function (e) { updatePosition(-window.scrollY, !1) }); navEl.find(".sectionList").find("a").on("click", function (e) { e.preventDefault(); scrollToElementJquery($(this).attr("href")) }) } function initWithTouch() { wrapperEl.attr("class", "touchable"); myScroll = new IScroll("#wrapper", { probeType: 3, mouseWheel: !0, click: !0 }); myScroll.on("scroll", function () { updatePosition(this.y, !0) }); myScroll.on("scrollEnd", function () { updatePosition(this.y, !0) }); navEl.find(".sectionList").find("a").on("click", function (e) { e.preventDefault(); scrollToElement($(this).attr("href")) }); nav2El.find(".sectionList").find("a").on("click", function (e) { e.preventDefault(); scrollToElement($(this).attr("href")) }); document.addEventListener("touchmove", function (e) { e.preventDefault() }, !1) } function initForAll() { languagesButtonEl.on("click", function () { toggleLanguages() }); tabsLinkEl.on("mouseenter", function () { changeMap($(this).attr("id")) }); tabsLinkEl.on("click", function () { clickMap($(this).attr("id")) }); winesLinkEl.on("click", function () { onWinesClick() }); winesLayerEl.find(".closeButton").on("click", function () { onWinesClick() }); menuLinkEl.on("click", function () { onMenuClick() }); menuLayerEl.find(".closeButton").on("click", function () { onMenuClick() }); navLogo.on("click", function () { $("body").stop(!0, !0).animate({ scrollTop: 0 }, 500) }); initScrollingEffect() } function toggleLanguages() { var e = 0; if (languagesEl.hasClass("close")) { languagesEl.addClass("open"); languagesEl.removeClass("close"); e = 0 } else { languagesEl.addClass("close"); languagesEl.removeClass("open"); e = -140 } languagesContainerEl.stop(!0, !0).animate({ top: e + "px" }, 500) } function scrollToElement(e) { myScroll.scrollToElement(document.querySelector(e), null, null, !0) } function scrollToElementJquery(e) { var t = $(e).position().top + 600; $("body").stop(!0, !0).animate({ scrollTop: t }, 500) } function changeMap(e) { var t = 0, n = "", r = ""; switch (e) { case "fromTracksLink": t = 0; n = "activated"; r = ""; break; case "fromMegeveLink": t = 1; n = ""; r = "activated" } tabsLinkEl.eq(0).attr("class", n); tabsLinkEl.eq(1).attr("class", r); tabsBackgroundEl.stop(!0, !0).animate({ left: 200 + t * 400 + "px" }, 500) } function clickMap(e) { var t = ""; switch (e) { case "fromTracksLink": t = "https://www.google.fr/maps/preview#!q=4775+Route+du+Jaillet+74120+Meg%C3%A8ve&data=!1m4!1m3!1d6779!2d6.5879178!3d45.8679696!4m15!2m14!1m13!1s0x478bfcccdf8814a7%3A0x45f1f07f3000199c!3m8!1m3!1d3035!2d6.5903447!3d45.8671946!3m2!1i1709!2i839!4f13.1!4m2!3d45.8671643!4d6.5903748"; break; case "fromMegeveLink": t = "https://www.google.fr/maps/preview#!data=!4m21!3m17!1m1!1zTWVnw6h2ZQ!1m5!1s4775+Route+du+Jaillet%2C+74120+Meg%C3%A8ve!2s0x478bfcccdf8814a7%3A0x45f1f07f3000199c!3m2!3d45.8671643!4d6.5903748!3m8!1m3!1d6779!2d6.5939903!3d45.866849!3m2!1i1790!2i937!4f13.1!5m2!13m1!1e1&fid=0" } window.open(t, "_blank") } function onWinesClick() { if (winesLayerEl.hasClass("open")) { winesLayerEl.removeClass("open"); winesLayerEl.stop(!0, !0).fadeOut(500) } else { winesLayerEl.addClass("open"); winesContainerEl.scrollTop(0); winesLayerEl.stop(!0, !0).fadeIn(500) } } function onMenuClick() { if (menuLayerEl.hasClass("open")) { menuLayerEl.removeClass("open"); menuLayerEl.stop(!0, !0).fadeOut(500) } else { menuLayerEl.addClass("open"); menuContainerEl.scrollTop(0); menuLayerEl.stop(!0, !0).fadeIn(500) } } function initScrollingEffect() { } var myScroll, position, navEl, nav2El, headerVisualPictureEl, wrapperEl, titleEl, languagesButtonEl, languagesEl, tabsLinkEl, mapsContainerEl, languagesContainerEl, winesLinkEl, winesLayerEl, winesContainerEl, menuLinkEl, menuLayerEl, menuContainerEl, tabsBackgroundEl, navLogo = null; $(document).ready(function () { init() });